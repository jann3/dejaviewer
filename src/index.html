<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>DejaViewer</title>
  <link href="https://fonts.googleapis.com/css?family=Blinker|Open+Sans" rel="stylesheet" />
  <link href="https://fonts.cdnfonts.com/css/chiller" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="style.css" />
  <script type="text/javascript">
    const { ipcRenderer } = require("electron");
    const { dialog } = require("electron").remote;

    ipcRenderer.on("error", (event, message) => {
      console.log("error", message);
      document.getElementById("fileHolder").innerHTML = message.toString();
    });

    document.addEventListener("drop", function (event) {
      event.preventDefault();
      event.stopPropagation();
      document.getElementById("fileHolder").innerHTML = "Opening..";

      for (let file of event.dataTransfer.files) {
        console.log("sending from drag/drop", file.path);
        ipcRenderer.send("filepath", file.path);
      }
    });

    document.addEventListener("dragover", function (event) {
      document.getElementById("fileHolder").innerHTML = "Drop To Open";
      event.preventDefault();
      event.stopPropagation();
    });

    document.addEventListener("dragleave", function (event) {
      document.getElementById("fileHolder").innerHTML = "Drag Your File Here";
      event.preventDefault();
      event.stopPropagation();
    });

    function openFile() {
      dialog.showOpenDialog(
        {
          filters: [
            { name: "JPEG", extensions: ["jpg", "jpeg"] },
            { name: "PNG", extensions: ["png"] },
            { name: "GIF", extensions: ["gif"] },
            { name: "TIFF", extensions: ["tif", "tiff"] },
            { name: "WebP", extensions: ["webp"] },
            { name: "AVIF", extensions: ["avif"] },
            {
              name: "All Image Files",
              extensions: [
                "jpg",
                "jpeg",
                "png",
                "gif",
                "webp",
                "ico",
                "bmp",
                "jfif",
                "pjpeg",
                "pjp",
                "svg",
                "svgz",
                "tiff",
                "tif",
                "webp",
                "avif",
                "xbm",
              ],
            },
          ],
        },
        (filepaths) => {
          if (filepaths === undefined) {
            console.log("no file selected");
            return false;
          } else {
            let filepath = filepaths[0];
            console.log("sending from selection", filepath);
            ipcRenderer.send("filepath", filepath);
          }
        }
      );
    }
  </script>
</head>

<body>
  <main>
    <aside>
      <svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 271.2 271.35">
        <defs>
          <style>
            .cls-1 {
              font-size: 77.74px;
              font-family: Chiller-Regular, Chiller;
            }

            .cls-1,
            .cls-2,
            .cls-3,
            .cls-4 {
              fill: #fff;
            }

            .cls-2 {
              font-size: 77.57px;
              font-family: Blinker-Bold, Blinker;
              font-weight: 700;
            }

            .cls-3 {
              opacity: 0.15;
            }
          </style>
        </defs>
        <g id="logo"><text class="cls-1" transform="translate(44.09 170.73)">
            <tspan xml:space="preserve"> viewer</tspan>
          </text><text class="cls-2" transform="translate(60.38 122.51)">Deja</text></g>
        <g id="frames">
          <polygon class="cls-3"
            points="31.32 32.47 31.32 204.78 53.37 204.78 53.37 54.52 204.78 54.52 204.78 32.47 31.32 32.47" />
          <polygon class="cls-4"
            points="242.89 32.47 242.89 54.52 249.15 54.52 249.15 249.3 53.37 249.3 53.37 242.89 31.32 242.89 31.32 271.35 271.2 271.35 271.2 32.47 242.89 32.47" />
          <path class="cls-4" d="M249.23,249.16H14.4V14.32H249.23Zm-212.83-22H227.23V36.32H36.4Z"
            transform="translate(-14.4 -14.32)" />
        </g>
      </svg>
    </aside>
    <ol>
      <li>
        <span>
          <div>Open an image by using the Browse button. Or drag and drop the file into this
            window.</div>
          <div>
            <input type="button" value="Browse" onclick="openFile();" />
          </div>
        </span>
      </li>
      <li>
        Make changes to your image file with an external editor and save it. The viewer will now
        automatically
        reload.
      </li>
    </ol>
  </main>
</body>

</html>